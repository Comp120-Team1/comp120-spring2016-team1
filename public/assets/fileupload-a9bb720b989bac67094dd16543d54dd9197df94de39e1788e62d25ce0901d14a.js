$(function(){$(".directUpload").find("input:file").each(function(a,e){var t=$(e),d=$(t.parents("form:first")),n=$(".uploader"),i=$("<div class='bar'></div>"),r=$("<div class='progress'></div>").append(i);t.after(r),t.fileupload({fileInput:t,url:d.data("url"),type:"POST",autoUpload:!0,formData:d.data("form-data"),paramName:"file",dataType:"XML",replaceFileInput:!0,progressall:function(a,e){var t=parseInt(e.loaded/e.total*100,10);i.css("width",t+"%")},start:function(a){n.prop("disabled",!0),i.css("background","green").css("display","block").css("width","0%").text("Loading...")},done:function(a,e){n.prop("disabled",!1),i.text("Uploading done");var r=$(e.jqXHR.responseXML).find("Key").text(),o="//"+d.data("host")+"/"+r,p=$("<input />",{type:"hidden",name:t.attr("name"),value:o});d.append(p)},fail:function(a,e){n.prop("disabled",!1),i.css("background","red").text("Failed")}})})});